# Popup 稳定币种 - 快速测试

## 🚀 1 分钟快速测试

### 步骤 1: 编译 (10秒)

```bash
cd /Users/zhangxuanyang/Desktop/Quant/dddd-alpha-extension
npm run build:popup
```

### 步骤 2: 重载插件 (5秒)

1. 打开 Chrome `chrome://extensions`
2. 找到 **Alpha Auto Bot**
3. 点击 🔄 **重新加载** 按钮

### 步骤 3: 打开 Popup (5秒)

1. 点击浏览器工具栏的插件图标
2. 查看 popup 窗口

### 步骤 4: 验证功能 (30秒)

检查以下内容：

#### ✅ 必须看到

1. **推荐稳定币种卡片**
   - 位置：popup 顶部（标题下方）
   - 图标：✅ 绿色对勾
   - 右上角：[详情 >] 按钮

2. **币种列表**
   - 加载状态："加载中..." 或 币种列表
   - 每个币种显示：
     - 币种名称（如 **ALEO**）
     - 绿色标签 [稳定]
     - 价差数值（如 价差:0.00）
     - 天数（如 天数:10）

3. **数据特征**
   - 只显示稳定币种
   - 价差都 ≤ 2.0
   - 最多 5 个币种
   - 按价差从小到大排序

#### ✅ 预期示例

```
┌─────────────────────────────────┐
│ ✅ 推荐稳定币种       [详情 >] │
├─────────────────────────────────┤
│ ALEO  [稳定]   价差:0.00 天数:10│
│ AOP   [稳定]   价差:0.00 天数:15│
│ KOGE  [稳定]   价差:0.02 天数:0 │
│ STAR  [稳定]   价差:0.59 天数:2 │
└─────────────────────────────────┘
```

### 步骤 5: 测试详情按钮 (10秒)

1. 点击右上角 **[详情 >]** 按钮
2. 应该打开新标签页显示完整看板
3. 验证完整看板数据正常

## 🐛 快速故障排查

### 问题 1: 看不到推荐币种卡片

**检查**:
```bash
# 1. 确认编译成功
ls -la extension/dist/popup/popup.js

# 2. 重新编译
npm run build:popup

# 3. 在 chrome://extensions 重新加载插件
```

### 问题 2: 显示"暂无推荐币种"

**原因**: 
- 当前没有符合条件的币种（稳定 + 价差≤2.0）
- 或网络请求失败

**检查**:
```bash
# 测试 API
curl https://alpha123.uk/stability/stability_feed_v2.json

# 查看返回数据中 st 和 spr 字段
```

### 问题 3: 一直显示"加载中..."

**检查**:
1. 打开 Chrome 开发者工具 (F12)
2. 切换到 Console 标签
3. 查看是否有错误信息
4. 检查 Network 标签是否有请求失败

**常见错误**:
- CORS 错误：检查 manifest.json 是否有 `https://alpha123.uk/*` 权限
- 网络超时：检查网络连接

## ✅ 完整测试清单

打印此清单逐项测试：

### 基础显示
- [ ] 卡片标题显示"✅ 推荐稳定币种"
- [ ] 右上角有"详情 >" 按钮
- [ ] 数据加载成功（无错误）
- [ ] 显示币种列表

### 币种信息
- [ ] 每个币种显示名称
- [ ] 有绿色"稳定"标签
- [ ] 显示价差数值
- [ ] 显示天数信息
- [ ] 价差都 ≤ 2.0

### 排序和数量
- [ ] 按价差从小到大排序
- [ ] 最多显示 5 个币种
- [ ] 只显示稳定币种

### 交互功能
- [ ] 点击"详情"打开看板
- [ ] 关闭 popup 再打开，数据保持

### 自动更新
- [ ] 打开 popup 立即加载
- [ ] 等待 30 秒，观察数据更新
- [ ] Network 标签显示新请求

## 📊 验证数据准确性

### 方法 1: 对比原始数据

1. 访问：https://alpha123.uk/stability/stability_feed_v2.json
2. 查看 JSON 数据
3. 对比 popup 显示的币种是否正确

### 方法 2: 验证筛选逻辑

在浏览器 Console 运行：

```javascript
// 获取原始数据
fetch('https://alpha123.uk/stability/stability_feed_v2.json')
  .then(r => r.json())
  .then(data => {
    console.log('所有币种:', data.items.length);
    
    // 筛选稳定且低价差的
    const stable = data.items.filter(item => 
      item.st.includes('stable') && item.spr <= 2.0
    );
    console.log('符合条件:', stable.length);
    console.log('币种列表:', stable.map(i => i.n));
  });
```

### 方法 3: 检查排序

确认 popup 中的币种：
- 第一个的价差 ≤ 第二个的价差
- 第二个的价差 ≤ 第三个的价差
- 以此类推

## 🎯 性能检查

### 1. 加载速度

- 打开 popup 到显示数据：< 1 秒
- 网络请求响应时间：< 500ms

### 2. 内存占用

1. 打开 Chrome 任务管理器 (Shift+Esc)
2. 找到插件进程
3. 查看内存使用：< 50MB

### 3. 网络流量

1. 打开开发者工具 Network 标签
2. 观察请求：
   - URL: `stability_feed_v2.json`
   - 大小: ~5KB
   - 频率: 每 30 秒一次

## 🔄 完整流程测试

### 场景 1: 首次使用

1. [ ] 编译项目
2. [ ] 加载插件
3. [ ] 打开 popup
4. [ ] 看到加载状态
5. [ ] 显示币种列表
6. [ ] 点击详情按钮
7. [ ] 打开完整看板

### 场景 2: 数据更新

1. [ ] 打开 popup
2. [ ] 记录当前币种
3. [ ] 等待 30 秒
4. [ ] 观察数据是否更新
5. [ ] 检查 Network 请求

### 场景 3: 错误处理

1. [ ] 断开网络
2. [ ] 打开 popup
3. [ ] 观察错误处理
4. [ ] 恢复网络
5. [ ] 关闭再打开 popup
6. [ ] 数据恢复正常

## 🎉 测试通过标准

所有以下项目都 ✅ 通过：

1. ✅ 卡片正常显示
2. ✅ 数据准确加载
3. ✅ 只显示稳定币种
4. ✅ 价差都 ≤ 2.0
5. ✅ 按价差排序
6. ✅ 最多 5 个币种
7. ✅ 自动更新正常
8. ✅ 详情按钮可用
9. ✅ 加载状态正确
10. ✅ 错误处理正常

**恭喜！Popup 稳定币种功能测试通过！** 🎊

---

**测试版本**: 0.1.1
**测试时间**: 1 分钟
**难度**: ⭐ 简单
