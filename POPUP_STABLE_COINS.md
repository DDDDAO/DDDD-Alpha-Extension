# Popup 稳定币种推荐 - 使用说明

## ✨ 新功能

现在插件 popup 中直接显示推荐的稳定币种列表，无需打开新标签页！

## 📊 功能特点

### 1. 智能筛选

自动筛选符合以下条件的币种：
- ✅ 稳定性状态为 **"稳定"** (green:stable)
- ✅ 价差基点 **≤ 2.0**
- ✅ 按价差从小到大排序
- ✅ 最多显示 5 个

### 2. 实时更新

- 🔄 每 30 秒自动刷新数据
- ⚡ 打开 popup 时立即加载
- 📡 数据来源：alpha123.uk

### 3. 简洁展示

每个币种显示：
- **币种名称** (如 ALEO)
- **稳定性标签** (绿色 "稳定")
- **价差基点** (如 0.02)
- **4倍天数** (如 10)

## 🎨 界面示例

```
┌────────────────────────────────┐
│ ✅ 推荐稳定币种      [详情 >] │
├────────────────────────────────┤
│ ALEO  [稳定]    价差:0.00 天数:10 │
│ AOP   [稳定]    价差:0.00 天数:15 │
│ KOGE  [稳定]    价差:0.02 天数:0  │
└────────────────────────────────┘
```

## 🚀 使用方法

### 1. 查看推荐币种

1. 点击浏览器工具栏的插件图标
2. 在 popup 顶部即可看到"推荐稳定币种"卡片
3. 列表自动显示符合条件的币种

### 2. 查看详细信息

点击卡片右上角的 **"详情"** 按钮，打开完整的稳定性看板：
- Top 3 推荐卡片（带评分和理由）
- 完整数据表格（所有币种）
- 评分说明和免责声明

### 3. 数据状态

- **加载中...** - 正在获取数据
- **币种列表** - 显示符合条件的币种
- **暂无推荐币种** - 当前没有符合条件的币种

## 🔧 技术细节

### 筛选逻辑

```typescript
const filtered = data.items
  .filter(item => {
    const isStable = item.st.includes('stable');    // 稳定性为"stable"
    const isLowSpread = item.spr <= 2.0;            // 价差 ≤ 2.0
    return isStable && isLowSpread;
  })
  .sort((a, b) => a.spr - b.spr)                    // 按价差排序
  .slice(0, 5);                                      // 最多5个
```

### 更新频率

- **初始加载**: popup 打开时立即获取
- **自动更新**: 每 30 秒刷新一次
- **手动刷新**: 关闭再打开 popup

### 数据源

- **API**: `https://alpha123.uk/stability/stability_feed_v2.json`
- **格式**: JSON
- **大小**: ~5KB
- **权限**: 已在 manifest.json 中添加

## 📈 预期效果

### 当前推荐（示例）

根据实时数据，通常会显示：

1. **ALEO** - 价差: 0.00, 天数: 10
2. **AOP** - 价差: 0.00, 天数: 15  
3. **KOGE** - 价差: 0.02, 天数: 0
4. **STAR** - 价差: 0.59, 天数: 2

### 为什么选择这些币种？

- ✅ **价差极低** - 交易成本最小
- ✅ **稳定性好** - 波动风险低
- ✅ **适合套利** - 符合自动交易策略

## ⚙️ 自定义配置

如需调整筛选条件，可修改常量：

```typescript
// src/popup/Popup.tsx

const MAX_SPREAD_THRESHOLD = 2.0;  // 价差阈值（基点）
const STABILITY_UPDATE_INTERVAL = 30000;  // 更新间隔（毫秒）

// 在筛选逻辑中修改最大显示数量
.slice(0, 5);  // 改为其他数字
```

## 🐛 故障排查

### 问题 1: 显示"暂无推荐币种"

**原因**: 
- 当前没有同时满足"稳定"且"价差 ≤ 2.0"的币种
- 网络连接失败

**解决**:
- 等待数据刷新（30秒后自动重试）
- 检查网络连接
- 点击"详情"查看完整列表

### 问题 2: 加载一直显示"加载中..."

**原因**:
- 网络请求超时
- API 服务不可用

**解决**:
```bash
# 1. 检查网络
ping alpha123.uk

# 2. 测试 API
curl https://alpha123.uk/stability/stability_feed_v2.json

# 3. 重新编译
npm run build:popup

# 4. 重新加载插件
```

### 问题 3: 数据不更新

**原因**:
- 自动更新定时器未启动

**解决**:
1. 关闭并重新打开 popup
2. 检查浏览器 Console 是否有错误
3. 重新加载插件

## 🔄 与完整看板的关系

### Popup 列表（新功能）
- ✅ 快速查看推荐币种
- ✅ 只显示稳定且低价差的
- ✅ 紧凑布局，适合快速浏览
- ✅ 每 30 秒自动更新

### 完整看板（点击"详情"）
- 📊 所有币种的详细信息
- 🏆 Top 3 推荐卡片（带评分）
- 📈 完整评分算法说明
- 🔄 每 8 秒自动更新

### 推荐使用场景

**使用 Popup 列表**:
- 快速查看当前稳定币种
- 决定是否需要调整策略
- 查看实时价差变化

**使用完整看板**:
- 深入分析币种数据
- 对比所有币种评分
- 了解评分算法逻辑

## 📝 更新日志

### v0.1.1 (2025-10-04)
- ✅ 在 popup 中直接显示稳定币种列表
- ✅ 智能筛选：稳定性 + 低价差
- ✅ 自动更新：每 30 秒刷新
- ✅ 保留"详情"按钮访问完整看板

### v0.1.0 (2025-10-04)
- ✅ 初始版本：独立的稳定性看板页面

## 🎯 未来优化

### 计划中的功能

1. **自定义筛选条件**
   - 用户可调整价差阈值
   - 可选择显示币种数量

2. **点击跳转**
   - 点击币种名称直接跳转到 Binance 交易页面

3. **收藏功能**
   - 收藏关注的币种
   - 价差预警

4. **历史对比**
   - 显示价差变化趋势
   - 稳定性历史记录

## ⚠️ 注意事项

1. **数据来源**
   - 数据来自第三方网站 alpha123.uk
   - 可能存在延迟或更新频率限制

2. **筛选条件**
   - 当前阈值：价差 ≤ 2.0 基点
   - 可根据需要自行调整

3. **免责声明**
   - 仅供参考，不构成投资建议
   - 请结合自己的判断和风险承受能力

---

**版本**: 0.1.1
**更新日期**: 2025-10-04
**状态**: ✅ 可用
